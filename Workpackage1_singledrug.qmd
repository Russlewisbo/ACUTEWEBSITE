---
title: "Workpackage 1-Single Drug"
date: "12/14/2022"
format: 
  html:
    code-fold: true
    number-sections: false
execute:
  echo: true
  warning: false
  freeze: false
bibliography: references.bib
csl: nature.csl
---

## WORKPACKAGE 1A: QUANTITATIVE RELATIONSHIP OF TPOS WITH BACTERIAL INOCULUM

### METHODS

In this package we will establish the quantitative relationship of Tpos and KPC-carbapenemase producing *Klebsiella pneumoniae* inoculum in blood culture bottles. <br>

The methods for the assay are a modification of those originally proposed by Kaltsas et al.[@kaltsas2005] Detailed procedures can be found at this [link](Protocols.html). Methodology for preparing the test inoculum was adapted from [CLSI M21A](CLSI_M21A.pdf) and [M26A](CLSI_M26A.pdf) guidelines.

-   Briefly, tubes containing 1.8 mL of pooled healthy human serum are inoculated with 0.2 mL of a series of ten-fold dilutions (5x10^1^ to 5x10^7^ CFU/mL) of the standardised inoculum of each test indicator strains.
-   The sera were are then transferred into BacT⁄ALERT bottles ***without antibiotic inactivating matrix*** (Biomérieux Inc) for aerobic incubation for 24 hours and monitored for time to positivity.
-   Tpos results were used to establish preliminary assay quality control ranges by testing in triplicate for five KPC-carbapenemase producing *K. pneumoniae* strains (KPC A, B and C strains; NDM, and VIM producing strains) and a reference *K. pneumoniae* ATCC strain producing ESBL enzyme only. More detailed information on the isolates can be found on the [Protocols](Protocols.html) section.
-   We also compared how Tpos results change if the organism suspension prepared in phosphate buffered saline (PBS-0.9%) versus pooled human serum (serum).

### RESULTS

The relationship between Tpos and the *K. pneumoniae* inoculum is shown in [@fig-1] a linear relationship was observed from approximately 10^1^-10^8^ *K. pneumoniae* CFU/mL and a Tpos measured from 10.5 hours-4.5 hours over the tested inoculum range, with R^2^ of 0.92-0.94. The linear relationship of Tpos versus inoculum was consistent if the inoculum was prepared in PBS or pooled human serum as shown in [@tbl-1].

::: callout-note
In the paper by Kaltsas et al. [@kaltsas2005] the reported inoculum was the inoculum introduced in to the bloodculture bottle, 30-40 mL of growth media (depending on the manufacturer).

Therefore we have followed this precedent of reporting the inoculum introduced into each bottle. Therefore, this does not represent the final test inoculum that need to account for the total 42 mL volume in each bloodculture bottle.

All experiments were performed using bloodculture bottles ***without antibiotic inactivating matrix***
:::

#### KLEBSIELLA PNEUMONIAE ISOLATES

```{r}
#| label: fig-1
#| fig-cap: "Relationship of time-to-positivity (Tpos) versus test inoculum"


library (ggplot2)
library(scales)
theme_set(theme_bw())
## import raw data from .csv file
wp1 <- read.csv("~/Desktop/ACUTEWEBSITE/wp1a.csv")
## plot raw data as x-y graph Tpos graph vs. drug concentrations stratified by dilution matrix, method="lm" is the method for linear regression
fig1 <-ggplot(wp1, aes(x=inoculum, y=tpos, color=isolates, shape=diluent, fill=isolates)) + geom_point(size=4, alpha = 0.5) + 
scale_y_continuous(name="Tpos (hr)", limits=c(4,12)) +
theme(legend.text=element_text(size=12)) +
geom_smooth(aes(linetype=diluent), method=lm , color="black", fill="#69b3a2", se=TRUE, inherit.aes = TRUE )
fig1 + theme_bw(base_size = 14)+ scale_x_log10(name="Inoculum CFU/mL", breaks = trans_breaks("log10",n=7, function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))

```

```{r}
#| label: tbl-1
#| tbl-cap: Effect of inoculum diluent on Tpos
library(forestmangr)
library(kableExtra)
wp1 <- read.csv("~/Desktop/ACUTEWEBSITE/wp1a.csv")
df <- data.frame (wp1)
table1<-lm_table(df, log(inoculum) ~ tpos, "diluent")
kbl(table1)%>%
kable_paper("hover", full_width = F, position="left")
```

------------------------------------------------------------------------

#### ESCHERICHIA COLI ATCC 25922

```{r}
#| label: fig-ecoli
#| fig-cap: "Relationship of time-to-positivity (Tpos) versus test inoculum"

## import raw data from .xlsx file
library (readxl)
ecoliatcc_inoc <- read_excel("datasets_single/ecoliatcc_inoculum.xlsx")
library (ggplot2)
library(scales)
theme_set(theme_bw())
## plot raw data as x-y graph Tpos graph vs. drug concentrations stratified by dilution matrix, method="lm" is the method for linear regression
figecoli <-ggplot(ecoliatcc_inoc, aes(x=inoculum, y=tpos)) + geom_point(size=4, alpha = 0.5) + 
scale_y_continuous(name="Tpos (hr)", limits=c(4,12)) +
theme(legend.text=element_text(size=12)) +
geom_smooth(aes(linetype=diluent), method=lm , color="black", fill="#69b3a2", se=TRUE, inherit.aes = TRUE )
fig1 + theme_bw(base_size = 14)+ scale_x_log10(name="Inoculum CFU/mL", breaks = trans_breaks("log10",n=7, function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))

```

```{r}
#| label: tbl-ecoli
#| tbl-cap: Effect of inoculum diluent on Tpos
library(forestmangr)
library(kableExtra)
library (readxl)
ecoliatcc_inoc <- read_excel("datasets_single/ecoliatcc_inoculum.xlsx")
dfecoli <- data.frame (ecoliatcc_inoc)
table1<-lm_table(dfecoli, log(inoculum) ~ tpos, "diluent")
kbl(table1)%>%
kable_paper("hover", full_width = F, position="left")
```

------------------------------------------------------------------------

#### ACINETOBACTER BAUMANII ATCC XXXX

```{r}
#| label: fig-1f
#| fig-cap: "Relationship of time-to-positivity (Tpos) versus test inoculum for Acinetobacter baumanii"


library (ggplot2)
library(scales)
theme_set(theme_bw())
## import raw data from .csv file
library (readxl)
abaumani <- read_excel("abaum_pbs.xlsx")
## plot raw data as x-y graph Tpos graph vs. drug concentrations stratified by dilution matrix, method="lm" is the method for linear regression
fig1 <-ggplot(abaumani, aes(x=inoculum, y=tpos)) + geom_point(size=4, alpha = 0.5) + 
scale_y_continuous(name="Tpos (hr)", limits=c(4,12)) +
theme(legend.text=element_text(size=12)) +
geom_smooth(aes(linetype=diluent), method=lm , color="black", fill="#69b3a2", se=TRUE, inherit.aes = TRUE )
fig1 + theme_bw(base_size = 14)+ scale_x_log10(name="Inoculum CFU/mL", breaks = trans_breaks("log10",n=7, function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))

```

```{r}
#| label: tbl-1f
#| tbl-cap: Effect of inoculum diluent on Tpos for Acinetobacter baumanii
library(forestmangr)
library(kableExtra)
library (readxl)
abaumani <- read_excel("abaum_pbs.xlsx")
df <- data.frame (abaumani)
table1<-lm_table(df, log(inoculum) ~ tpos, "diluent")
kbl(table1)%>%
kable_paper("hover", full_width = F, position="left")
```

------------------------------------------------------------------------

#### PSEUDOMONAS AERUGINOSA ATCC 27853

```{r}
#| label: fig-2f
#| fig-cap: "Relationship of time-to-positivity (Tpos) versus test inoculum for Pseudomonas aeruginosa"

library (ggplot2)
library(scales)
theme_set(theme_bw())
## import raw data from .csv file
library (readxl)
pseudo <- read_excel("pseudo_pbs.xlsx")
## plot raw data as x-y graph Tpos graph vs. drug concentrations stratified by dilution matrix, method="lm" is the method for linear regression
fig2f <-ggplot(pseudo, aes(x=inoculum, y=tpos, color=isolates, fill=isolates)) + geom_point(size=4, alpha = 0.5) + 
scale_y_continuous(name="Tpos (hr)", limits=c(4,12)) +
theme(legend.text=element_text(size=12)) +
geom_smooth(aes(linetype=diluent), method=lm , color="black", fill="#69b3a2", se=TRUE, inherit.aes = TRUE )
fig2f + theme_bw(base_size = 14)+ scale_x_log10(name="Inoculum CFU/mL", breaks = trans_breaks("log10",n=7, function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))


```

```{r}
#| label: tbl-2f
#| tbl-cap: Effect of inoculum diluent on Tpos for pseudomonas aeruginosa
library(forestmangr)
library(kableExtra)
library (readxl)
pseudo <- read_excel("pseudo_pbs.xlsx")
df_pseudo <- data.frame (pseudo)
table2<-lm_table(df_pseudo, log(inoculum) ~ tpos, "diluent")
kbl(table2)%>%
kable_paper("hover", full_width = F, position="left")
```

### CONCLUSIONS

These data confirm that Tpos exhibits a wide dynamic range and reproducible relationship as a surrogate indicator for viable CFU/mL.

------------------------------------------------------------------------

## WORKPACKAGE 1B: EFFECT OF ANTIBIOTIC EXPOSURE ON TPOS

### METHODS

This workpackage explores how cantibiotic concentrations alters Tpos for a standard (1x10^4^ CFU/mL) inoculum of Enterobacterales.

### RESULTS

------------------------------------------------------------------------

### CEFTAZIDIME-AVIBACTAM

#### Preliminary experiments KPC and NDM isolates

As shown in [@fig-2], a marked increased in the Tpos for KPC_B from \< 10 hrs to [\>]{.underline} 24 hrs when CAZ/AVI concentrations surpassed 1 mg/L. In contrast, the negative control KPC_NDM strain exhibited consistent Tpos \< 10hr at all test concentrations with lack of antimicrobial activity. Trends in Tpos relative to antibiotic exposure were fitted by Loess.

```{r}
#| label: fig-2
#| fig-cap: "Effect of ceftazidime/aviactam concentrations on Tpos of K. pneumoniae"

library (ggplot2)
theme_set(theme_bw())
ceftaz <- read.csv("~/Desktop/ACUTEWEBSITE/datasets_single/ceftazidime.csv")
ggplot(ceftaz, aes(x=conc_s, y=tpos, color=isolate, shape=isolate)) + 
  geom_point(size=4, alpha = 0.7) + 
  geom_smooth(aes(linetype=isolate), method= loess, color="black", fill="#69b3a2", se=TRUE, inherit.aes = TRUE ) +
scale_x_log10(name="CAZ/AVI conc, mg/L") +
scale_y_continuous(name="Tpos (hr)", limits=c(4,25)) 

```

| Isolate                        | Carbapenemase enzyme | Ceftazidime/avibactam Etest MIC (mg/L) |
|--------------------------------|----------------------|----------------------------------------|
| *Klebsiella pneumoniae* KPC- B | KPC-3                | 1                                      |
| *Klebsiella pneumoniae* NDM    | NDM-2                | \>64                                   |

: Isolates used for testing {#tbl-table2}

<br>

<br>

#### K. pneumoniae ATCC 700603 (MIC 0.03 mg/L) powder 4:1

```{r}
#| label: fig-1atcc
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_7a <- read_excel("datasets_single/kpatcc_caz_avi_powder4-1.xlsx")
fit_atcc <- drda(tpos ~ ctz_s, data=caz_avi_7a, mean_function = "loglogistic4", max_iter = 1000)
plot(fit_atcc, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-5a
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_7a <- read_excel("datasets_single/kpatcc_caz_avi_powder4-1.xlsx")
fit_atcc <- drda(tpos ~ ctz_s, data=caz_avi_7a, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit_atcc, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### K. pneumoniae ATCC 700603 (MIC 0.03 mg/L) fixed 4 mg/L

```{r}
#| label: fig-1atccfix
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_7b <- read_excel("datasets_single/kpatcc_caz_avi_powderfix4.xlsx")
fit_atcc2 <- drda(tpos ~ ctz_s, data=caz_avi_7b, mean_function = "loglogistic4", max_iter = 1000)
plot(fit_atcc2, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-atccfix
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_7a <- read_excel("datasets_single/kpatcc_caz_avi_powderfix4.xlsx")
fit7a <- drda(tpos ~ ctz_s, data=caz_avi_7a, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit7a, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC B (MIC 1 mg/L) commercial

```{r }
#| label: fig-3
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_4 <- read_excel("datasets_single/kpcb_caz_avi_com.xlsx")
fit4 <- drda(tpos ~ ctz_s, data=caz_avi_4, mean_function = "loglogistic4", max_iter = 1000)
plot(fit4, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-3
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_4 <- read_excel("datasets_single/kpcb_caz_avi_com.xlsx")
fit4 <- drda(tpos ~ ctz_s, data=caz_avi_4, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit4, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC B (MIC 1 mg/L) powder 4:1

```{r }
#| label: fig-4
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_6 <- read_excel("datasets_single/kpcb_caz_avi_powder_4-1.xlsx")
fit6 <- drda(tpos ~ ctz_s, data=caz_avi_6, mean_function = "loglogistic4", max_iter = 1000)
plot(fit6, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-4
#| tbl-cap: "Pharmacodynamic estimates"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_6 <- read_excel("datasets_single/kpcb_caz_avi_powder_4-1.xlsx")
fit6 <- drda(tpos ~ ctz_s, data=caz_avi_6, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit6, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC A (MIC 2 mg/L) commerical

```{r}
#| label: fig-5
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concencentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_7 <- read_excel("datasets_single/kpca_caz_avi_com.xlsx")
fit7 <- drda(tpos ~ ctz_s, data=caz_avi_7, mean_function = "loglogistic4", max_iter = 1000)
plot(fit7, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-5
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parametersestiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_7 <- read_excel("datasets_single/kpca_caz_avi_com.xlsx")
fit7 <- drda(tpos ~ ctz_s, data=caz_avi_7, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit7, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC A (MIC 2 mg/L) powder 4:1

```{r}
#| label: fig-6
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

library (readxl)
library(drda)
caz_avi_8 <- read_excel("datasets_single/kpca_caz_avi_powder_4-1.xlsx")
fit8 <- drda(tpos ~ ctz_s, data=caz_avi_8, mean_function = "loglogistic4", max_iter = 1000)
plot(fit8, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-6
#| tbl-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parametersestiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_8 <- read_excel("datasets_single/kpca_caz_avi_powder_4-1.xlsx")
fit8 <- drda(tpos ~ ctz_s, data=caz_avi_8, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit8, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC A (MIC 2 mg/L) fixed 4 mg/L

```{r}
#| label: fig-7
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_9 <- read_excel("datasets_single/kpca_caz_avi_powder_fix4.xlsx")
fit9 <- drda(tpos ~ ctz_s, data=caz_avi_9, mean_function = "loglogistic4", max_iter = 1000)
plot(fit9, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-7 
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_9 <- read_excel("datasets_single/kpca_caz_avi_powder_fix4.xlsx")
fit9 <- drda(tpos ~ ctz_s, data=caz_avi_9, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit9, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC B (MIC 1 mg/L) fixed 4 mg/L

```{r}
#| label: fig-8
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_10 <- read_excel("datasets_single/kpcb_caz_avi_powder_fix4.xlsx")
fit10<- drda(tpos ~ ctz_s, data=caz_avi_10, mean_function = "loglogistic4", max_iter = 1000)
plot(fit10, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-8
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameters estiamtes plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_10 <- read_excel("datasets_single/kpcb_caz_avi_powder_fix4.xlsx")
fit10 <- drda(tpos ~ ctz, data=caz_avi_10, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit10, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC B (MIC 1 mg/L) high inoculum

We examined how the relationship of Tpos vs. ceftazidime/avibactam concentrations changes when tested against a higher inoculum (1x10^7^ CFU/mL). The same methodology as described above was used for testing. As shown in [@fig-3a] and [@tbl-3a] the EC~50~ and EC~90~ were marginally higher when tested at the higher inoculum with a more shallow dose-response relationship.

```{r }
#| label: fig-3a
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against a high-inoculum"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_5 <- read_excel("datasets_single/kpcb_caz_avi_com_hinoc.xlsx")
fithinc <- drda(tpos ~ ctz_s, data=caz_avi_5, mean_function = "loglogistic4", max_iter = 1000)
plot(fithinc, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-3a
#| tbl-cap: "Pharmacodynamic estimates for a high-inoculum"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_5 <- read_excel("datasets_single/kpcb_caz_avi_com_hinoc.xlsx")
fithinc <- drda(tpos ~ ctz_s, data=caz_avi_5, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fithinc, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC Catania (MIC 16 mg/L) powder 4:1

```{r }
#| label: fig-catan1
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against a resistant strain"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_catan <- read_excel("datasets_single/kpccatania_caz_avi_powder_4-1.xlsx")
fitcat <- drda(tpos ~ ctz_s, data=caz_avi_catan, mean_function = "loglogistic4", max_iter = 1000)
plot(fitcat, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-catan1
#| tbl-cap: "Pharmacodynamic estimates for a high-inoculum"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_5 <- read_excel("datasets_single/kpccatania_caz_avi_powder_4-1.xlsx")
fitcat <- drda(tpos ~ ctz_s, data=caz_avi_catan, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitcat, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")

```

<br>

<br>

#### KPC Catania (MIC 16 mg/L) fixed 4 mg/L

```{r }
#| label: fig-catfix
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against a high-inoculum"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_5 <- read_excel("datasets_single/kpccatania_caz_avi_powder_4-1.xlsx")
fitcat5 <- drda(tpos ~ ctz_s, data=caz_avi_5, mean_function = "loglogistic4", max_iter = 1000)
plot(fitcat5, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-catfix
#| tbl-cap: "Pharmacodynamic estimates for a high-inoculum"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_5 <- read_excel("datasets_single/kpccatania_caz_avi_powder_4-1.xlsx")
fit5 <- drda(tpos ~ ctz_s, data=caz_avi_5, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit5, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### KPC K. pneumoniae KPRAD (MIC 0.5 mg/L)

```{r }
#| label: fig-kprad
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against KPC- producing K. pneumoniae"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_kprad <- read_excel("~/datasets_single/kp_PRAD_caz_avi_powder4-1.xlsx")
fitkprad <- drda(tpos ~ ctz_s, data=caz_avi_kprad, mean_function = "loglogistic4", max_iter = 1000)
plot(fitkprad, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-kprad
#| tbl-cap: "Pharmacodynamic estimates"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_kprad <- read_excel("datasets_single/kp_PRAD_caz_avi_powder4-1.xlsx")
fitkprad <- drda(tpos ~ ctz_s, data=caz_avi_kprad, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitkprad, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### KPC K. pnuemoniae KFAB (MIC 0.38 mg/L)

```{r }
#| label: fig-kfab
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against KPC- producing K. pneumoniae"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_kfab <- read_excel("datasets_single/kp_FAB_caz_avi_powder4-1.xlsx")
fitkfab <- drda(tpos ~ ctz_s, data=caz_avi_kfab, mean_function = "loglogistic4", max_iter = 1000)
plot(fitkfab, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-kfab
#| tbl-cap: "Pharmacodynamic estimates"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_kfab <- read_excel("datasets_single/kp_FAB_caz_avi_powder4-1.xlsx")
fitkfab <- drda(tpos ~ ctz_s, data=caz_avi_kfab, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitkprad, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### K. pneumoniae WT (MIC 0.125 mg/L)

```{r }
#| label: fig-wtpow
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against a wt strain"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_wt2 <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
fitwt <- drda(tpos ~ ctz_s, data=caz_avi_wt2, mean_function = "loglogistic4", max_iter = 1000)
plot(fitwt, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-wtpow
#| tbl-cap: "Pharmacodynamic estimates K. pneumoniae WT (MIC 0.125 mg/L) "
library (readxl)
library(drda)
caz_avi_wt2 <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
fitwt <- drda(tpos ~ ctz_s, data=caz_avi_wt2, mean_function = "loglogistic4", max_iter = 1000)

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_5 <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
fitwt2 <- drda(tpos ~ ctz_s, data=caz_avi_wt2, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitwt, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### K. pneumoniae WT (MIC 0.125 mg/L) fixed 4 mg/L

```{r }
#| label: fig-wt
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against a wt strain"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_wt <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
fitwt <- drda(tpos ~ ctz_s, data=caz_avi_wt, mean_function = "loglogistic4", max_iter = 1000)
plot(fitwt, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-wt
#| tbl-cap: "Pharmacodynamic estimates K. pneumoniae WT (MIC 0.125 mg/L) "


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_5 <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
fitwt <- drda(tpos ~ ctz_s, data=caz_avi_wt, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitwt, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

<br>

<br>

#### E. coli ATCC 25922 (MIC 0.19 mg/L)

```{r }
#| label: fig-ecoliatcc
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations against E. coli ATCC 25922 (MIC 0.19 mg/L)"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
caz_avi_ecoli <- read_excel("datasets_single/ecoliatcc_caz_avi_powder4-1.xlsx")
fitecoli <- drda(tpos ~ ctz_s, data=caz_avi_ecoli, mean_function = "loglogistic4", max_iter = 1000)
plot(fitecoli, xlab = "CAZ/AVI serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-ecoliatcc
#| tbl-cap: "Pharmacodynamic estimates for a high-inoculum"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
caz_avi_ecoli <- read_excel("datasets_single/ecoliatcc_caz_avi_powder4-1.xlsx")
fitecoli <- drda(tpos ~ ctz_s, data=caz_avi_ecoli, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitecoli, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### COMPARISON OF POSSIBLE INDICATOR ISOLATES

```{r }
#| label: fig-compkp
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
kpca <- read_excel("datasets_single/kpca_caz_avi_powder_4-1.xlsx")
kpcb <- read_excel("datasets_single/kpcb_caz_avi_powder_4-1.xlsx")
kpccatania <- read_excel("datasets_single/kpccatania_caz_avi_powder_4-1.xlsx")
caz_avi_kfab <- read_excel("datasets_single/kp_FAB_caz_avi_powder4-1.xlsx")
kpwt <- read_excel("datasets_single/kpwt_caz_avi_powder_4-1.xlsx")
caz_avi_kprad <- read_excel("datasets_single/kp_PRAD_caz_avi_powder4-1.xlsx")

## fit models for each of the isolates
fitkpca <- drda(tpos ~ ctz_s, kpca, mean_function = "loglogistic4", max_iter = 1000)
fitkpcb <- drda(tpos ~ ctz_s, kpcb, mean_function = "loglogistic4", max_iter = 1000)
fitkpccatania <- drda(tpos ~ ctz_s, kpccatania, mean_function = "loglogistic4", max_iter = 1000)
fitkpwt <- drda(tpos ~ ctz_s, kpwt, mean_function = "loglogistic4", max_iter = 1000)
fitkfab <- drda(tpos ~ ctz_s, data=caz_avi_kfab, mean_function = "loglogistic4", max_iter = 1000)
fitkprad <- drda(tpos ~ ctz_s, data=caz_avi_kprad, mean_function = "loglogistic4", max_iter = 1000)
## plot all of the isolates together
p <-plot(fitkpca, fitkpcb, fitkpccatania, fitkpwt, fitkfab, fitkprad, base="10", xlab = "Ceftazidime-avibactam conc. (mg/L)", ylab = "Tpos",cex = 0.9, legend_location="topleft", legend = c("2 mg/L", "1 mg/L",  "16 mg/L", "0.125 mg/L", "0.5 mg/L", "0.38 mg/L")) 
```


#### CONCLUSIONS

These data demonstrate that Tpos is a robust PD endpoint and the relationship of ceftazidime/avibactam concentrations versus Tpos follows classical sigmoidal dose response relationship with a steep transitional portion of the dose response curve that occurs near the MIC of the pathogen. Although ED50/90 estimates were broadly similar if the commercial (pharmaceutical) and analytical powder formulations were tested, used of high-fixed concentrations of avibactam or testing at very high *K. pneumoniae* inocula resulted in broader concentration-effect curves and higher EC50/90 estimates. <br> <br>

------------------------------------------------------------------------

### MEROPENEM

##### K. pneumoniae ATCC (MIC 0.03 mg/L)

-   The impact of increasing meropenem concentrations on Tpos observed with the ATCC ESBL producing *Klebsiella pneumoniae* was tested using similar methodology as previously described

-   Analytical powder was used to produce serum concentration

-   As shown in [@fig-9], Tpos increased as meropenem concentrations surpassed the MIC, with an estimated pharmacodynamic parameters consistent with previous experiments that showed transition in the EC50/EC90 at simulated serum concentrations near the MIC as shown in [@tbl-9].

```{r}
#| label: fig-9
#| fig-cap: "Pharmacodynamic relationship of Tpos to meropenem concentrations"

## a four-parameter logistic regression model is fit to meropenem concentrations to estimated PD parameters
library (readxl)
library(drda)
mero <- read_excel("datasets_single/ATCC_meropenem.xlsx")
fit11 <- drda(tpos ~ mero_s, data=mero, mean_function = "loglogistic4", max_iter = 1000)
plot(fit11, xlab = "Meropenem serum conc. (mg/L)", ylab = "Tpos (hr)", xlim =c(0,100))

```

```{r}
#| label: tbl-9
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
mero <- read_excel("datasets_single/ATCC_meropenem.xlsx")
fit11 <- drda(tpos ~ mero_s, data=mero, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit11, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

##### KPC B (MIC 32 mg/L)

```{r}
#| label: fig-9b
#| fig-cap: "Pharmacodynamic relationship of Tpos to meropenem concentrations"

## a four-parameter logistic regression model is fit to meropenem concentrations to estimated PD parameters
library (readxl)
library(drda)
mero2 <- read_excel("datasets_single/KPCB_meropenem.xlsx")
fit11 <- drda(tpos ~ mero_s, data=mero2, mean_function = "loglogistic4", max_iter = 1000)
plot(fit11, xlab = "Meropenem serum conc. (mg/L)", ylab = "Tpos (hr)", xlim =c(0,100))

```

```{r}
#| label: tbl-9b
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
mero2 <- read_excel("datasets_single/KPCB_meropenem.xlsx")
fit11 <- drda(tpos ~ mero_s, data=mero2, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit11, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

##### Comparison of ATCC and KPC B isolates

<br> A comparison of meropenem activity against the ATCC ESBL-producing reference (MIC 0.03 mg/L) and KPC-carbapenemase producing K. pneumoniae isolates are shown in [@fig-comp]. The meropenem EC~50~ measured by Tpos was 23-fold higher for the KPC-carbapenemase producing isolate versus the the ESBL-producing ATCC isolate. Despite variability in the response was noted for the KPC-B isolate at 20 mg/L and 80 mg/mL concentrations (*experiments are currently being repeated*), the EC50 were nearly identical (indicated by the dotted lines) when corrected for pathogen MIC. These data suggest that it may be possible to substitute *sensitive indicator isolates with low MICs* to predict pharmacodynamic responses of isolates with higher MICs.

```{r }
#| label: fig-comp
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
mero2 <- read_excel("datasets_single/KPCB_meropenem.xlsx")
mero <- read_excel("datasets_single/ATCC_meropenem.xlsx")
fit4a <- drda(tpos ~ mero, mero, mean_function = "loglogistic4", max_iter = 1000)
fit4b <- drda(tpos ~ mero, mero2, mean_function = "loglogistic4", max_iter = 1000)
plot(fit4a, fit4b, xlab = "Meropenem conc. (mg/L)", ylab = "Tpos",cex = 0.9,legend = c("KP ATCC ESBL", "KP KPC_2"))
```

#### CONCLUSIONS

Similar to cefetazidime-avibactam, experiments with meropenem demonstrated that Tpos is a robust PD endpoint and the relationship of meropenem concentrations versus Tpos follows classical sigmoidal dose response relationship with a steep transitional portion of the dose response curve that occurs near the MIC of the pathogen. <br>

A key observation is that the pharmacodynamics were similar when meropenem was tested against a highly-susceptible ATCC isolate (MIC 0.03 mg/L) and and the KPC-producing K.pneumoniae B isolate (MIC 32 mg/L) with at proportional difference in the EC50/90. **Therefore, it may be possible to use highly-susceptible "indicator" strains for testing to predict activity against more resistant isolates.** This is important because direct testing of 1 mL inoculum may routinely result in limited antimicrobial activity measured by Tpos (\<10 hours) as dilutional effects when the serum samples is introduced into the bottle containing a total volume of 42 mL will reduce the actual testing concentrations of the antibiotics below the MIC for highly resistant pathogens. <br> <br> This effect could be counteracted by testing with highly sensitive "indicator" isolates based on the expected serum concentrations of the antibiotic.

------------------------------------------------------------------------

### GENTAMICIN

##### KPC A (MIC 2 mg/L)

```{r}
#| label: fig-genta
#| fig-cap: "Pharmacodynamic relationship of Tpos to gentamicin concentrations"

## a four-parameter logistic regression model is fit to gentamicin concentrations to estimated PD parameters
library (readxl)
library(drda)
gent1 <- read_excel("datasets_single/KPCA_gent.xlsx")
fit12 <- drda(tpos ~ gent_s, data=gent1, mean_function = "loglogistic4", max_iter = 1000)
plot(fit12, xlab = "Gentamicin serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-genta
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
gent1 <- read_excel("datasets_single/KPCA_gent.xlsx")
fit12 <- drda(tpos ~ gent_s, data=gent1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit12, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

##### KPC B (MIC 0.5 mg/L)

```{r}
#| label: fig-gentb
#| fig-cap: "Pharmacodynamic relationship of Tpos to gentamicin concentrations"

## a four-parameter logistic regression model is fit to gentamicin concentrations to estimated PD parameters
library (readxl)
library(drda)
gent2 <- read_excel("datasets_single/KPCB_gent.xlsx")
fit13 <- drda(tpos ~ gent_s, data=gent2, mean_function = "loglogistic4", max_iter = 1000)
plot(fit13, xlab = "Gentamicin serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-gentb
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
gent2 <- read_excel("datasets_single/KPCB_gent.xlsx")
fit13 <- drda(tpos ~ gent_s, data=gent2, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit13, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### CONCLUSIONS

------------------------------------------------------------------------

### COLISTIN

#### KPC B (MIC 0.125 mg/L)

```{r}
#| label: fig-colib
#| fig-cap: "Pharmacodynamic relationship of Tpos to colistin concentrations"

## a four-parameter logistic regression model is fit to colistin concentrations to estimated PD parameters
library (readxl)
library(drda)
coli1 <- read_excel("datasets_single/KPCB_coli.xlsx")
fit14 <- drda(tpos ~ coli_s, data=coli1, mean_function = "loglogistic4", max_iter = 1000)
plot(fit14, xlab = "Colistin serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-colib
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
coli1 <- read_excel("datasets_single/KPCB_coli.xlsx")
fit14 <- drda(tpos ~ coli_s, data=coli1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit14, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### CONCLUSIONS

------------------------------------------------------------------------

### MEROPENEM-VABORBACTAM

#### KPC B (MIC X mg/L)

```{r}
#| label: fig-vabob
#| fig-cap: "Pharmacodynamic relationship of Tpos to meropenem-vaborbactam concentrations"

## a four-parameter logistic regression model is fit to meropenem-vaborbactam concentrations to estimated PD parameters
library (readxl)
library(drda)
vabo1 <- read_excel("datasets_single/KPCB_vabo.xlsx")
fit14 <- drda(tpos ~ vabo_s, data=vabo1, mean_function = "loglogistic4", max_iter = 1000)
plot(fit14, xlab = "Meropenem-vabobactam serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-vabob
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
vabo1 <- read_excel("datasets_single/KPCB_vabo.xlsx")
fit14 <- drda(tpos ~ vabo_s, data=vabo1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit14, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### CONCLUSIONS

------------------------------------------------------------------------

### TIGECYCLINE

::: callout-important
Experiments performed using freshly collected blood samples that use EDTA as an anticoagulant result in enhanced tigecycline activity.[@Deitchman2018a] This phenomena was evident in preliminary experiments as shown in [@fig-edta].

```{r}
#| label: fig-edta
#| fig-cap: "Effect of tigeycvcline concentrations on Tpos of K. pneumoniae using serum collected with and withouth EDTA"
library (readxl)
library (ggplot2)
theme_set(theme_bw())
edta <- read_excel("datasets_single/edtaeffect.xlsx")
ggplot(edta, aes(x=tig_s, y=tpos, color=tube, shape=tube)) + 
  geom_point(size=4, alpha = 0.7) + 
scale_x_continuous (name="Tigecycline conc, mg/L") +
scale_y_continuous(name="Tpos (hr)", limits=c(4,25)) 

```
:::

#### KPC-A (MIC 0.75 mg/L)

```{r}
#| label: fig-tiga
#| fig-cap: "Pharmacodynamic relationship of Tpos to tigecycline concentrations"

## a four-parameter logistic regression model is fit to tigecycline concentrations to estimated PD parameters
library (readxl)
library(drda)
tig1 <- read_excel("datasets_single/kpca_tig.xlsx")
fit15 <- drda(tpos ~ tig_s, data=tig1, mean_function = "loglogistic4", max_iter = 1000)
plot(fit15, xlab = "Tigecycline serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-tiga
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
tig1 <- read_excel("datasets_single/kpca_tig.xlsx")
fit15 <- drda(tpos ~ tig_s, data=tig1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit15, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### KPC-B (MIC 0.38 mg/L)

```{r}
#| label: fig-tigb
#| fig-cap: "Pharmacodynamic relationship of Tpos to tigecycline concentrations"

## a four-parameter logistic regression model is fit to tigecycline concentrations to estimated PD parameters
library (readxl)
library(drda)
tig2 <- read_excel("datasets_single/kpcb_tig.xlsx")
fit16 <- drda(tpos ~ tig_s, data=tig2, mean_function = "loglogistic4", max_iter = 1000)
plot(fit16, xlab = "Tigecycline serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-tigb
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
tig2 <- read_excel("datasets_single/kpca_tig.xlsx")
fit16 <- drda(tpos ~ tig_s, data=tig2, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit16, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### E. coli ATCC 25922 (MIC 0.125 mg/L)

```{r}
#| label: fig-tigecoli
#| fig-cap: "Pharmacodynamic relationship of Tpos to tigecycline concentrations"

## a four-parameter logistic regression model is fit to tigecycline concentrations to estimated PD parameters
library (readxl)
library(drda)
tigecoli <- read_excel("datasets_single/ecoliatcc_tig.xlsx")
fittigecoli <- drda(tpos ~ tig_s, data=tigecoli, mean_function = "loglogistic4", max_iter = 1000)
plot(fittigecoli, xlab = "Tigecycline serum conc. (mg/L)", ylab = "Tpos (hr)")

```

```{r}
#| label: tbl-tigecoli
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
tigecoli <- read_excel("datasets_single/ecoliatcc_tig.xlsx")
fittigecoli <- drda(tpos ~ tig_s, data=tigecoli, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fittigecoli, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### E. coli ATCC 25922 (MIC 0.125 mg/L) protein binding

```{r }
#| label: fig-protein
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
serum <- read_excel("datasets_single/ecoliatcc_tig_serum.xlsx")
pbs <- read_excel("datasets_single/ecoliatcc_tig_pbs.xlsx")
fitserum <- drda(tpos ~ tig_s, serum, mean_function = "loglogistic4", max_iter = 1000)
fitpbs <- drda(tpos ~ tig_s, pbs, mean_function = "loglogistic4", max_iter = 1000)
plot(fitserum, fitpbs, xlab = "Tigecycline conc. (mg/L)", ylab = "Tpos",cex = 0.9,legend = c("serum", "PBS"))
```

```{r }
#| label: fig-protein1
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime/avibactam concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
library(broom)
library(kableExtra)
serum <- read_excel("datasets_single/ecoliatcc_tig_serum.xlsx")
pbs <- read_excel("datasets_single/ecoliatcc_tig_pbs.xlsx")
fitserum <- drda(tpos ~ tig_s, serum, mean_function = "loglogistic4", max_iter = 1000)
fitpbs <- drda(tpos ~ tig_s, pbs, mean_function = "loglogistic4", max_iter = 1000)
edserum<-effective_dose(fitserum, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
edpbs<-effective_dose(fitpbs, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(edserum)%>%
kable_paper("hover", full_width = F, position = "left")
kbl(edpbs)%>%
kable_paper("hover", full_width = F, position = "left")

```

#### CONCLUSIONS

------------------------------------------------------------------------

### CEFTAZIDIME

#### K. pneumoniae ATCC 700603 (MIC 12 mg/L)

```{r }
#| label: fig-ceftaz_atcc
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime concentrations against an ESBL producing ATCC strain"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
ceftaz_atcc <- read_excel("datasets_single/kpatcc_ceftazidime.xlsx")
fit_ceftazatcc <- drda(tpos ~ ctz_s, data=ceftaz_atcc, mean_function = "loglogistic4", max_iter = 1000)
plot(fit_ceftazatcc, xlab = "Ceftazidime serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-ceftaz_atcc
#| tbl-cap: "Pharmacodynamic estimates"


## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
ceftaz_atcc <- read_excel("datasets_single/kpatcc_ceftazidime.xlsx")
fit_ceftazatcc <- drda(tpos ~ ctz_s, data=ceftaz_atcc, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit_ceftazatcc, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### K. pneumoniae KP-DAM (MIC 4 mg/L)

```{r}
#| label: fig-ceftaz_dam
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
ceftaz1 <- read_excel("datasets_single/kp_dam_ceftaz.xlsx")
fit17 <- drda(tpos ~ ctz_s, data=ceftaz1, mean_function = "loglogistic4", max_iter = 1000)
plot(fit17, xlab = "Ceftazidime serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-ceftaz_dam
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
ceftaz1 <- read_excel("datasets_single/kp_dam_ceftaz.xlsx")
fit17 <- drda(tpos ~ ctz_s, data=ceftaz1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fit17, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### CONCLUSIONS

------------------------------------------------------------------------

### CIPROFLOXACIN

#### K. pneumoniae WT (MIC \<= 0.06)

```{r}
#| label: fig-ciprowt
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
cipro1 <- read_excel("datasets_single/kpwt_cipro_powder.xlsx")
fitcipro1 <- drda(tpos ~ cipro_s, data=cipro1, mean_function = "loglogistic4", max_iter = 1000)
plot(fitcipro1, xlab = "Ciprofloxacin serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-ciprowt
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
cipro1 <- read_excel("datasets_single/kpwt_cipro_powder.xlsx")
fitcipro1 <- drda(tpos ~ cipro_s, data=cipro1, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitcipro1, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### KPC B (MIC \<= 0.38)

```{r}
#| label: fig-ciprokpcb
#| fig-cap: "Pharmacodynamic relationship of Tpos to ceftazidime concentrations"

## a four-parameter logistic regression model is fit to ceftazidime concentrations to estimated PD parameters
library (readxl)
library(drda)
cipro2 <- read_excel("datasets_single/kpcb_cipro_powder.xlsx")
fitcipro2 <- drda(tpos ~ cipro_s, data=cipro2, mean_function = "loglogistic4", max_iter = 1000)
plot(fitcipro2, xlab = "Ciprofloxacin serum conc. (mg/L)", ylab = "Tpos (hr)")
```

```{r}
#| label: tbl-ciprokpcb
#| tbl-cap: "Pharmacodynamic estimates"

## Analysis is repeated to produce a table reporting estimated EC10-EC95 parameter estimates plus 95% CI 
library (readxl)
library(drda)
library(broom)
library(kableExtra)
cipro2 <- read_excel("datasets_single/kpcb_cipro_powder.xlsx")
fitcipro2 <- drda(tpos ~ cipro_s, data=cipro2, mean_function = "loglogistic4", max_iter = 1000)
ed<-effective_dose(fitcipro2, y = c(0.10,0.25,0.50,0.75,0.90,0.95))
kbl(ed)%>%
kable_paper("hover", full_width = F, position = "left")
```

#### CONCLUSIONS

## REFERENCES
